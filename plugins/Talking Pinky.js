/* Codded by Phaticusthiccy
eva artificial intelligence was codded by Phaticusthiccy
also 90% of thise code is done by Phaticusthiccy
re-coded or modified by afnanplk
to bring new ai
*/


const MyPnky = require('../events');
const ffmpeg = require('fluent-ffmpeg');
const fs = require('fs');
const https = require('https');
const googleTTS = require('google-translate-tts');
const { MessageType, Mimetype, MessageOptions } = require('@adiwajshing/baileys');
const Language = require('../language');
const Lang = Language.getString('voicy');
const afn = require('./sql/ai');
const plk32 = require('./sql/tryplk');
const conf = require('../config');
const axios = require('axios')
const axiosdef = require("axios").default;
const os = require('os')
const translatte = require('translatte');
const LanguageDetect = require('languagedetect');
const lngDetector = new LanguageDetect();
const Heroku = require('heroku-client');
const heroku = new Heroku({
    token: conf.HEROKU.API_KEY
});
let baseURI = '/apps/' + conf.HEROKU.APP_NAME;

let wk = conf.WORKTYPE == 'public' ? false : true
var vtalk_dsc = ''
var reply_eva = ''
if (conf.LANG == 'TR') vtalk_dsc = 'Eva sesli sohbetini başlatır.', reply_eva = '*Herhangi Bir Sesli Mesaja Yanıt Verin!*'
if (conf.LANG == 'EN') vtalk_dsc = 'Starts to pinky voice chat.', reply_eva = '*Reply to Any Voice Message!*'
if (conf.LANG == 'AZ') vtalk_dsc = 'Eva səsli söhbətinə başlayır.', reply_eva = '*Hər hansı bir səsli mesaja cavab verin!*'
if (conf.LANG == 'PT') vtalk_dsc = 'Começa o bate-papo por voz de Eva.', reply_eva = '*Responder a qualquer mensagem de voz!*'
if (conf.LANG == 'RU') vtalk_dsc = 'Запускает голосовой чат Eva.', reply_eva = '*Ответьте на любое голосовое сообщение!*'
if (conf.LANG == 'HI') vtalk_dsc = 'Eva ध्वनि चैट प्रारंभ करता है', reply_eva = '*किसी भी ध्वनि संदेश का उत्तर दें!*'
if (conf.LANG == 'ES') vtalk_dsc = 'Comienza con el chat de voz de Eva.', reply_eva = '*¡Responde a cualquier mensaje de voz!*'
if (conf.LANG == 'ML') vtalk_dsc = 'വോയ്‌സ് ചാറ്റിലേക്ക് ആരംഭിക്കുന്നു.', reply_eva = '*ഏത് വോയ്‌സ് സന്ദേശത്തിനും മറുപടി നൽകുക!*'
if (conf.LANG == 'ID') vtalk_dsc = 'Mulai obrolan suara Eva.', reply_eva = '*Balas Pesan Suara Apapun!*'

const recognizeAudio = () => {
    const headers = new Headers({
        'Content-Type': 'audio/wav',
        "Authorization": `Bearer ${conf.WITAI_API}`,
        'Cache-Control': 'no-cache',
        'Transfer-Encoding': 'chunked'
    })
    const requestBody = {
        method: "POST",
        body: fs.readFileSync('output.wav'),
        headers: headers
    }
    return fetch("https://api.wit.ai/speech?v=20200219", requestBody)
        .then(response => response.json())
        .then(json => json._text)
}
const convertToWav = file => {
    return ffmpeg(file)
        .audioCodec('pcm_s16le')
        .format('wav')
        .save('output.wav')
}
if (conf.STANDPLK == 'off' || conf.STANDPLK == 'OFF') {
function _0x48fe(){var _0x4651fa=['synthesize','8117352KeHQEH','cnt','get','g.us','startsWith','auto','waifu','6CXLFll','3066600NmWQVi','mention','2564048PXyNPN','message','7d57838203','dSaveMedia','s1229n77c8','user','msh0c582ja','97324rCBsWD','data','k19865261j','downloadAn','.ai/get?bi','sendMessag','14cmMnnK','LANG','log','Duplicated','c90a7231p1','length','then','d=159506&k','http://api','age','26UwXGRA','addCommand','cfa55871','&msg=','catch','.brainshop','1570cbQdFR','3b461jsn77','client','53603lMJzgk','addplk','mp4Audio','getAI','{normal}','uid=','reply_mess','Whats','vtalk$','map','text','toLowerCas','homedir','Asena','2928370GttdWt','true','end','raw','6JPdxT8As&','c8cfa55871','includes','replace','userInfo','quotedMess','msh0c5cf65','ey=4QPRlFg','{pinky}','10543TRsuya','jid','PINKY_PM','split'];_0x48fe=function(){return _0x4651fa;};return _0x48fe();}var _0x4703f6=_0x3f74;function _0x3f74(_0x5d94d1,_0xcf0379){var _0x48fe97=_0x48fe();return _0x3f74=function(_0x3f747b,_0x406c00){_0x3f747b=_0x3f747b-0x1b9;var _0x1c011b=_0x48fe97[_0x3f747b];return _0x1c011b;},_0x3f74(_0x5d94d1,_0xcf0379);}(function(_0x5d3e0d,_0x2f6047){var _0x848791=_0x3f74,_0x328358=_0x5d3e0d();while(!![]){try{var _0x292079=-parseInt(_0x848791(0x1e0))/0x1*(parseInt(_0x848791(0x1bc))/0x2)+-parseInt(_0x848791(0x1ed))/0x3+parseInt(_0x848791(0x1f6))/0x4+-parseInt(_0x848791(0x1d3))/0x5*(parseInt(_0x848791(0x1ec))/0x6)+-parseInt(_0x848791(0x1fc))/0x7*(-parseInt(_0x848791(0x1ef))/0x8)+parseInt(_0x848791(0x1e5))/0x9+parseInt(_0x848791(0x1c2))/0xa*(parseInt(_0x848791(0x1c5))/0xb);if(_0x292079===_0x2f6047)break;else _0x328358['push'](_0x328358['shift']());}catch(_0x503371){_0x328358['push'](_0x328358['shift']());}}}(_0x48fe,0x8f687),MyPnky[_0x4703f6(0x1bd)]({'on':_0x4703f6(0x1cf),'fromMe':wk,'dontAddCommandList':!![],'deleteCommand':![]},async(_0xda6117,_0x536cd4)=>{var _0x26cf29=_0x4703f6,_0x291a99=await plk32[_0x26cf29(0x1c6)](_0xda6117['jid']);if(_0x291a99!==![]){_0x291a99=_0x291a99[_0x26cf29(0x1f0)];if(!_0x291a99[_0x26cf29(0x1d9)](_0x26cf29(0x1df))){if(_0xda6117[_0x26cf29(0x1f0)][_0x26cf29(0x1e9)]('pinky')){var _0x3ccca7=await afn[_0x26cf29(0x1c8)](_0xda6117[_0x26cf29(0x1e1)]);let _0x42b72a=_0x3ccca7===![]||_0x3ccca7[_0x26cf29(0x1f0)][_0x26cf29(0x201)]<0x2?'en':_0x3ccca7[_0x26cf29(0x1f0)];var _0x435c80=_0xda6117[_0x26cf29(0x1c4)][_0x26cf29(0x1f4)][_0x26cf29(0x1e1)][_0x26cf29(0x1e3)]('@')[0x0];let _0x3de1aa=os[_0x26cf29(0x1db)]()[_0x26cf29(0x1d1)][_0x26cf29(0x1e3)](_0x26cf29(0x1cc))[0x1][_0x26cf29(0x1e3)](_0x26cf29(0x1ff)+'/')[0x0]==_0x26cf29(0x1d2)?_0x26cf29(0x1f1)+_0x26cf29(0x1dd)+_0x26cf29(0x200)+'3b461jsn77'+'c8cfa55871':_0x26cf29(0x1f1)+_0x26cf29(0x1f5)+_0x26cf29(0x1f8)+'s1229n77c8'+_0x26cf29(0x1be),_0x47b445=_0xda6117[_0x26cf29(0x1f0)]['includes'](_0x26cf29(0x1c9))?_0x26cf29(0x1d6):'waifu';var _0x389b44=_0xda6117[_0x26cf29(0x1f0)][_0x26cf29(0x1da)]('pinky','')[_0x26cf29(0x1da)]('\x20',''),_0x29473d=os[_0x26cf29(0x1db)]()['homedir'][_0x26cf29(0x1e3)]('Whats')[0x1][_0x26cf29(0x1e3)](_0x26cf29(0x1ff)+'/')[0x0];if(_0x29473d!=='Asena')return;var _0x4a8246='';ceviri=await translatte(_0x389b44,{'from':_0x26cf29(0x1ea),'to':'EN'});_0x26cf29(0x1cf)in ceviri&&(_0x4a8246=ceviri[_0x26cf29(0x1cf)]);var _0x1b258e=encodeURI(_0x4a8246);await axios[_0x26cf29(0x1e7)](_0x26cf29(0x1ba)+_0x26cf29(0x1c1)+_0x26cf29(0x1fa)+_0x26cf29(0x1b9)+_0x26cf29(0x1de)+_0x26cf29(0x1d7)+_0x26cf29(0x1ca)+_0x435c80+_0x26cf29(0x1bf)+_0x1b258e)[_0x26cf29(0x202)](async _0x1718c5=>{var _0x54bc16=_0x26cf29,_0x38f33c='';ceviri=await translatte(_0x1718c5['data'][_0x54bc16(0x1e6)],{'from':_0x54bc16(0x1ea),'to':_0x42b72a}),_0x54bc16(0x1cf)in ceviri&&(_0x38f33c=ceviri[_0x54bc16(0x1cf)]),await _0xda6117['client'][_0x54bc16(0x1fb)+'e'](_0xda6117['jid'],_0x38f33c,MessageType[_0x54bc16(0x1cf)],{'quoted':_0xda6117['data']});});}}}}),MyPnky[_0x4703f6(0x1bd)]({'on':_0x4703f6(0x1cf),'fromMe':![],'deleteCommand':![]},async(_0x2e6853,_0x4b2f61)=>{var _0x11309b=_0x4703f6,_0x4e75de=await plk32[_0x11309b(0x1c6)](_0x2e6853[_0x11309b(0x1e1)]);if(_0x4e75de!==![]){_0x4e75de=_0x4e75de['message'];var _0x55c948=await afn[_0x11309b(0x1c8)](_0x2e6853[_0x11309b(0x1e1)]);let _0x2f73f8=_0x55c948===![]||_0x55c948[_0x11309b(0x1f0)][_0x11309b(0x201)]<0x2?'ml':_0x55c948[_0x11309b(0x1f0)];if(_0x4e75de['includes'](_0x11309b(0x1df))&&(!_0x2e6853[_0x11309b(0x1e1)][_0x11309b(0x1d9)](_0x11309b(0x1e8))||_0x2e6853[_0x11309b(0x1e1)][_0x11309b(0x1d9)](_0x11309b(0x1e8))&&(_0x2e6853['mention']!==![]&&_0x2e6853['mention'][_0x11309b(0x201)]!==0x0||_0x2e6853[_0x11309b(0x1cb)+_0x11309b(0x1bb)]!==![]))){if(_0x2e6853['jid'][_0x11309b(0x1d9)](_0x11309b(0x1e8))&&(_0x2e6853['mention']!==![]&&_0x2e6853[_0x11309b(0x1ee)][_0x11309b(0x201)]!==0x0))_0x2e6853[_0x11309b(0x1ee)][_0x11309b(0x1ce)](async _0x2bae30=>{var _0x2c7b7c=_0x11309b;if(_0x2e6853['client']['user'][_0x2c7b7c(0x1e1)][_0x2c7b7c(0x1e3)]('@')[0x0]===_0x2bae30[_0x2c7b7c(0x1e3)]('@')[0x0]){var _0x518733=_0x2e6853['client'][_0x2c7b7c(0x1f4)][_0x2c7b7c(0x1e1)][_0x2c7b7c(0x1e3)]('@')[0x0];let _0x152753=os[_0x2c7b7c(0x1db)]()['homedir']['split']('Whats')[0x1][_0x2c7b7c(0x1e3)]('Duplicated'+'/')[0x0]==_0x2c7b7c(0x1d2)?_0x2c7b7c(0x1f1)+_0x2c7b7c(0x1dd)+_0x2c7b7c(0x200)+_0x2c7b7c(0x1c3)+_0x2c7b7c(0x1d8):_0x2c7b7c(0x1f1)+_0x2c7b7c(0x1f5)+_0x2c7b7c(0x1f8)+'s1229n77c8'+_0x2c7b7c(0x1be),_0x38fc96=_0x2e6853[_0x2c7b7c(0x1f0)][_0x2c7b7c(0x1d9)](_0x2c7b7c(0x1c9))?_0x2c7b7c(0x1d6):_0x2c7b7c(0x1eb);var _0x53f084=os[_0x2c7b7c(0x1db)]()[_0x2c7b7c(0x1d1)][_0x2c7b7c(0x1e3)]('Whats')[0x1][_0x2c7b7c(0x1e3)]('Duplicated'+'/')[0x0];if(_0x53f084!==_0x2c7b7c(0x1d2))return;var _0x13f954=_0x2e6853[_0x2c7b7c(0x1f0)],_0x2e2fc4='';ceviri=await translatte(_0x13f954,{'from':_0x2c7b7c(0x1ea),'to':'EN'});_0x2c7b7c(0x1cf)in ceviri&&(_0x2e2fc4=ceviri[_0x2c7b7c(0x1cf)]);var _0x1ad7de=encodeURI(_0x2e2fc4);await axios['get'](_0x2c7b7c(0x1ba)+_0x2c7b7c(0x1c1)+'.ai/get?bi'+_0x2c7b7c(0x1b9)+_0x2c7b7c(0x1de)+_0x2c7b7c(0x1d7)+'uid='+_0x518733+_0x2c7b7c(0x1bf)+_0x1ad7de)['then'](async _0xfc2be2=>{var _0x3b0766=_0x2c7b7c,_0x55b6e4='';ceviri=await translatte(_0xfc2be2[_0x3b0766(0x1f7)][_0x3b0766(0x1e6)],{'from':'auto','to':_0x2f73f8}),'text'in ceviri&&(_0x55b6e4=ceviri[_0x3b0766(0x1cf)]),await _0x2e6853[_0x3b0766(0x1c4)][_0x3b0766(0x1fb)+'e'](_0x2e6853[_0x3b0766(0x1e1)],_0x55b6e4,MessageType[_0x3b0766(0x1cf)],{'quoted':_0x2e6853['data']});});}});else{if(_0x2e6853[_0x11309b(0x1e1)]['includes'](_0x11309b(0x1e8))&&_0x2e6853[_0x11309b(0x1cb)+'age']!==![]){if(_0x2e6853[_0x11309b(0x1cb)+_0x11309b(0x1bb)]['jid'][_0x11309b(0x1e3)]('@')[0x0]===_0x2e6853[_0x11309b(0x1c4)][_0x11309b(0x1f4)][_0x11309b(0x1e1)][_0x11309b(0x1e3)]('@')[0x0]){var _0x12a197=_0x2e6853['client'][_0x11309b(0x1f4)][_0x11309b(0x1e1)][_0x11309b(0x1e3)]('@')[0x0];let _0x1c75ac=os[_0x11309b(0x1db)]()[_0x11309b(0x1d1)][_0x11309b(0x1e3)](_0x11309b(0x1cc))[0x1]['split'](_0x11309b(0x1ff)+'/')[0x0]==_0x11309b(0x1d2)?_0x11309b(0x1f1)+'msh0c5cf65'+'c90a7231p1'+_0x11309b(0x1c3)+_0x11309b(0x1d8):_0x11309b(0x1f1)+'msh0c582ja'+_0x11309b(0x1f8)+_0x11309b(0x1f3)+_0x11309b(0x1be);var _0x3236e4=os['userInfo']()[_0x11309b(0x1d1)][_0x11309b(0x1e3)]('Whats')[0x1][_0x11309b(0x1e3)](_0x11309b(0x1ff)+'/')[0x0];if(_0x3236e4!==_0x11309b(0x1d2))return;var _0xb0ab5f=_0x2e6853[_0x11309b(0x1f0)],_0x1ded28='';ceviri=await translatte(_0xb0ab5f,{'from':_0x11309b(0x1ea),'to':'EN'});_0x11309b(0x1cf)in ceviri&&(_0x1ded28=ceviri['text']);var _0x55c0a2=encodeURI(_0x1ded28);await axios[_0x11309b(0x1e7)](_0x11309b(0x1ba)+_0x11309b(0x1c1)+_0x11309b(0x1fa)+_0x11309b(0x1b9)+_0x11309b(0x1de)+'6JPdxT8As&'+'uid='+_0x12a197+_0x11309b(0x1bf)+_0x55c0a2)[_0x11309b(0x202)](async _0x11cf78=>{var _0x1388a0=_0x11309b,_0x4cacf6='';ceviri=await translatte(_0x11cf78[_0x1388a0(0x1f7)][_0x1388a0(0x1e6)],{'from':_0x1388a0(0x1ea),'to':_0x2f73f8}),_0x1388a0(0x1cf)in ceviri&&(_0x4cacf6=ceviri['text']),await _0x2e6853[_0x1388a0(0x1c4)][_0x1388a0(0x1fb)+'e'](_0x2e6853['jid'],_0x4cacf6,MessageType['text'],{'quoted':_0x2e6853[_0x1388a0(0x1f7)]});});}}}}}}),MyPnky['addCommand']({'on':_0x4703f6(0x1cf),'fromMe':![],'deleteCommand':![]},async(_0x2db2a2,_0x12d683)=>{var _0x1f46f5=_0x4703f6,_0x55604b=await afn[_0x1f46f5(0x1c8)](_0x2db2a2['jid']);let _0x3087c1=_0x55604b===![]||_0x55604b[_0x1f46f5(0x1f0)][_0x1f46f5(0x201)]<0x2?'ml':_0x55604b[_0x1f46f5(0x1f0)];if(conf[_0x1f46f5(0x1e2)]==_0x1f46f5(0x1d4)&&!_0x2db2a2[_0x1f46f5(0x1e1)][_0x1f46f5(0x1d9)](_0x1f46f5(0x1e8))){var _0x48712f=_0x2db2a2['client'][_0x1f46f5(0x1f4)]['jid'][_0x1f46f5(0x1e3)]('@')[0x0];let _0x42a5fc=os['userInfo']()[_0x1f46f5(0x1d1)][_0x1f46f5(0x1e3)]('Whats')[0x1][_0x1f46f5(0x1e3)]('Duplicated'+'/')[0x0]==_0x1f46f5(0x1d2)?_0x1f46f5(0x1f1)+_0x1f46f5(0x1dd)+_0x1f46f5(0x200)+_0x1f46f5(0x1c3)+'c8cfa55871':_0x1f46f5(0x1f1)+_0x1f46f5(0x1f5)+'k19865261j'+'s1229n77c8'+_0x1f46f5(0x1be);var _0x2350f8=os[_0x1f46f5(0x1db)]()['homedir']['split']('Whats')[0x1][_0x1f46f5(0x1e3)](_0x1f46f5(0x1ff)+'/')[0x0];if(_0x2350f8!==_0x1f46f5(0x1d2))return;var _0x2f9677=_0x2db2a2[_0x1f46f5(0x1f0)],_0x5d728b='';ceviri=await translatte(_0x2f9677,{'from':_0x1f46f5(0x1ea),'to':'EN'});'text'in ceviri&&(_0x5d728b=ceviri['text']);var _0x5377f1=encodeURI(_0x5d728b);await axios['get'](_0x1f46f5(0x1ba)+'.brainshop'+_0x1f46f5(0x1fa)+_0x1f46f5(0x1b9)+_0x1f46f5(0x1de)+_0x1f46f5(0x1d7)+'uid='+_0x48712f+_0x1f46f5(0x1bf)+_0x5377f1)[_0x1f46f5(0x202)](async _0x4ded1b=>{var _0x1fbff6=_0x1f46f5,_0x21d495='';ceviri=await translatte(_0x4ded1b[_0x1fbff6(0x1f7)][_0x1fbff6(0x1e6)],{'from':_0x1fbff6(0x1ea),'to':_0x3087c1}),_0x1fbff6(0x1cf)in ceviri&&(_0x21d495=ceviri[_0x1fbff6(0x1cf)]),await _0x2db2a2[_0x1fbff6(0x1c4)]['sendMessag'+'e'](_0x2db2a2[_0x1fbff6(0x1e1)],_0x21d495,MessageType[_0x1fbff6(0x1cf)],{'quoted':_0x2db2a2['data']});});}}),MyPnky['addCommand']({'pattern':_0x4703f6(0x1cd),'desc':vtalk_dsc,'dontAddCommandList':!![],'fromMe':wk},async(_0x496eeb,_0x48e755)=>{var _0x25bc04=_0x4703f6;if(!_0x496eeb[_0x25bc04(0x1cb)+_0x25bc04(0x1bb)])return await _0x496eeb['client']['sendMessag'+'e'](_0x496eeb[_0x25bc04(0x1e1)],reply_eva,MessageType[_0x25bc04(0x1cf)],{'quoted':_0x496eeb[_0x25bc04(0x1f7)]});try{const _0x1b3bdb=await _0x496eeb[_0x25bc04(0x1c4)][_0x25bc04(0x1f9)+_0x25bc04(0x1f2)+'Message']({'key':{'remoteJid':_0x496eeb[_0x25bc04(0x1cb)+_0x25bc04(0x1bb)][_0x25bc04(0x1e1)],'id':_0x496eeb[_0x25bc04(0x1cb)+_0x25bc04(0x1bb)]['id']},'message':_0x496eeb[_0x25bc04(0x1cb)+_0x25bc04(0x1bb)][_0x25bc04(0x1f7)][_0x25bc04(0x1dc)+_0x25bc04(0x1bb)]});convertToWav(_0x1b3bdb)['on'](_0x25bc04(0x1d5),async()=>{var _0x550016=_0x25bc04;const _0x291d9e=await recognizeAudio();var _0x3baee7='';ceviri=await translatte(_0x291d9e,{'from':_0x550016(0x1ea),'to':'EN'});'text'in ceviri&&(_0x3baee7=ceviri[_0x550016(0x1cf)]);var _0x4a8113=_0x496eeb['client'][_0x550016(0x1f4)][_0x550016(0x1e1)][_0x550016(0x1e3)]('@')[0x0];let _0x3ea0ff=os['userInfo']()['homedir']['split']('Whats')[0x1][_0x550016(0x1e3)]('Duplicated'+'/')[0x0]==_0x550016(0x1d2)?_0x550016(0x1f1)+_0x550016(0x1dd)+_0x550016(0x200)+_0x550016(0x1c3)+_0x550016(0x1d8):'7d57838203'+'msh0c582ja'+_0x550016(0x1f8)+_0x550016(0x1f3)+_0x550016(0x1be);var _0x2c925d=os['userInfo']()[_0x550016(0x1d1)][_0x550016(0x1e3)](_0x550016(0x1cc))[0x1][_0x550016(0x1e3)](_0x550016(0x1ff)+'/')[0x0];if(_0x2c925d!==_0x550016(0x1d2))return;var _0x501ca2=encodeURI(_0x3baee7);await axios[_0x550016(0x1e7)](_0x550016(0x1ba)+_0x550016(0x1c1)+_0x550016(0x1fa)+_0x550016(0x1b9)+_0x550016(0x1de)+_0x550016(0x1d7)+_0x550016(0x1ca)+_0x4a8113+_0x550016(0x1bf)+_0x501ca2)[_0x550016(0x202)](async _0x13b57a=>{var _0x4bf8f4=_0x550016,_0x5df942='';cevir=await translatte(_0x13b57a[_0x4bf8f4(0x1f7)][_0x4bf8f4(0x1e6)],{'from':_0x4bf8f4(0x1ea),'to':conf['LANG']});_0x4bf8f4(0x1cf)in cevir&&(_0x5df942=cevir[_0x4bf8f4(0x1cf)]);let _0x24f7f4=conf[_0x4bf8f4(0x1fd)][_0x4bf8f4(0x1d0)+'e'](),_0x1efe14=_0x5df942,_0x13d58a=0x1;var _0xa7b888=await googleTTS[_0x4bf8f4(0x1e4)]({'text':_0x1efe14,'voice':_0x24f7f4});await _0x496eeb['client']['sendMessag'+'e'](_0x496eeb[_0x4bf8f4(0x1e1)],_0xa7b888,MessageType['audio'],{'mimetype':Mimetype[_0x4bf8f4(0x1c7)],'ptt':!![],'quoted':_0x496eeb['data']});})[_0x550016(0x1c0)](async _0x11a342=>{var _0x490ecc=_0x550016;console[_0x490ecc(0x1fe)](_0x11a342);});});}catch(_0x3ce9f9){console['log'](_0x3ce9f9);}}));}
